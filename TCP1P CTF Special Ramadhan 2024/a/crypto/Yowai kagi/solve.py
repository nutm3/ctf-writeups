from Crypto.Util.number import inverse, bytes_to_long, long_to_bytes
#encProc = [b'\xe7M\xde\xa1\x13\x8c>\x0f\x0c\x02\xc7<\x9aF\x95\xc2\xa1\x90\xa4\x93sEa\xd9\xbd\xdc\x01\xf6O\xc3\x01Y\x89\x12\xba\x03]\xf6\x97h\xa6\xb9L\xbd\x1b\xfb\xba\x90\xaf\xdf\x90\xe2+\xae3\x06Q\x83\xc1\xe5\x94\x92\xb8\xfas\x8b\x1d\xbdb\x93\x93\x07\x12T\x8f3#\x01\xd3w\xd7\x96\xeaV\xae)d\x84W#\xd5\x97\xc5~\xb4\x0b);\xbd\xfd,Lg\x8bZ\x0b\x8f u\n|9\x0b@p\x05F\xf8+QDHQg\xfc\xbb\x05.', 174074464316835538482184680001658192242410825388376907636477842824191443684645308228203233974220832188117583297191087613707209445376372476904969987329345257218523073605475609089019124992042210016457959240271656826017315704293319015244687378364557458668679822645340657844143376734558755181517726112992266293641]
#encProc = [b'\x0b[\xf0N\xe38\xb33_\xbc<\xe0\xdc\xb0\x8b\xd2\xd4u?\x94\x81\x87?\xb3D\xa7\x8c\xa6\xefD,\xbe\x11m\x08_3\xdf\xfd\x03\x99a\xfb^\x99\xa6\xb5\xc0\xc3\xd3\xe5P\xa8\xad,n8\xdaD\xfb\x80\xd7\x04\xff\xce\xb6}\xaf\xae\x84\xe6\x1d6\xdf-\xd5\xfd\x82/\x9b,\xe0\x9c\xc0h\x93\x97\xec\xa8Rbu\xa01b\x18U\x15\
#encProc = [b"\xd5\x01=\xb0\x06\xd5\x19\x8d\xc5X\xadl\x94\r\x8d\x1cJ\xc5\xfd\x83C\x04\x1a\xcd3\xa6@\x8e;EuC\xe9O\xc0\x10\xdf'\x7fkq\x081\xdf\xf9\xcf]\xa7\xfc\xdd\xa6\xedX\\\xa0\x08\xcc\x85\xbe\xd9'}\xa6\xf5/\x95\x03 \x08\x01\x00\xa5\xc3.\xbd\xcb\x9a\x06\x02\xab#d\xf5\xad/.Jp\xda\xb4\x99\x97`(\xea\xf7O\x05\xbb\xc6]m\x12\x81\xffd\xc1\x8fk\x99\x93S\xf2bN\xdc;\xefQ\xaa\x8eNR\xc4\xd0+qp", 154113971713403749888577869453014960453036588507172296557624678027795607173517570502370891926602703732369716579720458904184086125167541433111426066774331343014623362401977287547579605236376207391083339415583426340233642584516779095857674027620510863242011049614532369384634144506390343085186222458957297360793]
#[b'\xe7M\xde\xa1\x13\x8c>\x0f\x0c\x02\xc7<\x9aF\x95\xc2\xa1\x90\xa4\x93sEa\xd9\xbd\xdc\x01\xf6O\xc3\x01Y\x89\x12\xba\x03]\xf6\x

cp_target = 7670464943683481095056710457985026703409532451058251841700668975990147225922599838831279292483461244597252911708576745698098232778030292714602130262861208700129558410710421435197752512991293144258412110321815201617687659949546354130548917892639281838672250788602948304310794473279598153292666756220837146237
#encProc = [b'\n\xecP\x96>\xb6X\x02Fs6\xf6\x8a\x1e\xfeH\xf2\xf6V\xe2\xa6\xb9\xa5\xf0\x7f4\xef\xc8\xe4c_t\xda\xb9\x1a\xe6R:\x07\xda}\x86l\xdc2\xfc\xden\xbdU\xcd-\x1c\xcd\xd7\xcb\xb9\xa4\x8c\xfd+8\xc0\x16\xbe\xfa&LC\xac\x9di+\xb5tf\xd2\xa4\x93\x94\xbd\xfb\x92$\xd3u\x06\x89\xe8\xf5\x93\x8d\xaa\xbe\xacj\x1aW\xa4\xede\x816\xa4\x97R#l\x17p\xfd\x0f\x8f\xc7r\xa07*\xf6\xb9\xff\x02Y\x188w\xae}', 147542323766143980997153505073685754466296787451766631986592004328984174625349184132117865050844453419799227189812573300515832115787619716745414186653931441837770093781721868529117854247578349510810209392299879118057634301443155952479534821650097384013083697432231735062234737245590680061947602501737231650919]
encProc = [b'\xe7M\xde\xa1\x13\x8c>\x0f\x0c\x02\xc7<\x9aF\x95\xc2\xa1\x90\xa4\x93sEa\xd9\xbd\xdc\x01\xf6O\xc3\x01Y\x89\x12\xba\x03]\xf6\x97h\xa6\xb9L\xbd\x1b\xfb\xba\x90\xaf\xdf\x90\xe2+\xae3\x06Q\x83\xc1\xe5\x94\x92\xb8\xfas\x8b\x1d\xbdb\x93\x93\x07\x12T\x8f3#\x01\xd3w\xd7\x96\xeaV\xae)d\x84W#\xd5\x97\xc5~\xb4\x0b);\xbd\xfd,Lg\x8bZ\x0b\x8f u\n|9\x0b@p\x05F\xf8+QDHQg\xfc\xbb\x05.', 174074464316835538482184680001658192242410825388376907636477842824191443684645308228203233974220832188117583297191087613707209445376372476904969987329345257218523073605475609089019124992042210016457959240271656826017315704293319015244687378364557458668679822645340657844143376734558755181517726112992266293641]

e = 65537
n = encProc[1]
cp = encProc[0]
cp = bytes_to_long(cp)

#------oke cp-------
print(f'cp bytes_to_long : {cp} \n cp target : {cp_target}')


#-------hitung p & q ( phi ) dari n
p = 1086027579223696553
q = 952809000096560291
phi = n-1

print(f'n : {n}')
print(f'phi : {phi}')


#-----cari d ------
d = inverse(e, phi)

#print("Nilai e:", e)
print("Nilai d:", d)

c = pow(cp, d, n)

print(f'c : {c}')




'''
'''
c = long_to_bytes(c)
print(c)
'''
m_hex = hex(c)[2:]
print(f'mhex : {m_hex}')
decoded_message = bytes.fromhex(m_hex).decode('utf-8')
print(decoded_message)



#c = long_to_bytes(c)
#print(f'result : {c}')


'''
